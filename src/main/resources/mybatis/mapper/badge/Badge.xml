<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.swyp.doubleSeven.domain.badge.dao.BadgeDAO">

    <!-- resultMap -->
    <resultMap id="BadgeResultMap" type="com.swyp.doubleSeven.domain.badge.dto.response.BadgeResponse">
        <id property="badgeId" column="BADGE_ID"/>
        <result property="badgeName" column="BADGE_NAME"/>
        <result property="emblemPath" column="EMBLEM_PATH"/>
        <result property="badgeType" column="BADGE_TYPE"/>
        <result property="mainCategoryId" column="MAIN_CATEGORY_ID"/>
        <result property="operator" column="OPERATOR"/>
        <result property="value" column="VALUE"/>
        <result property="rgstDt" column="RGST_DT"/>
        <result property="updtDt" column="UPDT_DT"/>
    </resultMap>

    <!-- 관리자-뱃지 등록-->
    <insert id="insertBadge" parameterType="com.swyp.doubleSeven.domain.badge.dto.BadgeRequest" useGeneratedKeys="true" keyProperty="badgeId">
        INSERT INTO BADGE (
            BADGE_NAME,
            EMBLEM_PATH,
            BADGE_TYPE,
            MAIN_CATEGORY_ID,
            OPERATOR,
            VALUE
        ) VALUES (
            #{badgeName},
            #{emblemPath},
            #{badgeType},
            #{mainCategoryId},
            #{operator},
            #{value}
        )
    </insert>

    <!-- 관리자-뱃지 업데이트 -->
    <update id="updateBadge" parameterType="BadgeRequest">
        UPDATE BADGE SET
            BADGE_NAME = #{badgeName},
            EMBLEM_PATH = #{emblemPath},
            BADGE_TYPE = #{badgeType},
            MAIN_CATEGROY_ID = #{mainCategoryId},
            OPERATOR = #{operator},
            VALUE = #{value},
            UPDT_ID = #{userId},
            UPDT_DT = NOW()
        WHERE BADGE_ID = #{badgeId}
    </update>

    <!--뱃지 삭제-->
    <delete id="deleteBadge" parameterType="int">
        DELETE BADGE
        WHERE BADGE_ID = #{badgeId}
    </delete>



    <!-- 특정 뱃지 조회 -->
    <select id="getBadgeById" resultType="com.swyp.doubleSeven.domain.badge.dto.BadgeDto">
        SELECT
        badge_id AS badgeId,
        badge_name AS badgeName,
        emblem_path AS emblemPath,
        badge_type AS badgeType,
        badge_category_id AS badgeCategoryId,
        operator,
        value,
        register_name AS registerName,
        created_date AS createdDate,
        updated_date AS updatedDate
        FROM Badge
        WHERE badge_id = #{badgeId}
    </select>

    <!-- 전체 뱃지 목록 조회 -->
    <select id="getAllBadges" resultType="com.swyp.doubleSeven.domain.badge.dto.BadgeDto">
        SELECT
        badge_id AS badgeId,
        badge_name AS badgeName,
        emblem_path AS emblemPath,
        badge_type AS badgeType,
        badge_category_id AS badgeCategoryId,
        operator,
        value,
        register_name AS registerName,
        created_date AS createdDate,
        updated_date AS updatedDate
        FROM Badge
    </select>

</mapper>
